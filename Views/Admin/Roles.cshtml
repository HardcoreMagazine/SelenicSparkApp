@using Microsoft.AspNetCore.Identity;
@using SelenicSparkApp.Data;

@inject SignInManager<IdentityUser> SignInManager
@inject ApplicationDbContext AppDbContext

@model IEnumerable<IdentityUser>
@{
	ViewData["Title"] = "Manage roles";
}

@*
	MULTI-PAGE VIEW WILL NOT BE ADDED FOR THIS PAGE
	SINCE NO ONE USES 100+ ROLES IN THEIR SYSTEM
*@

<style>
	.grid-page {
		display: grid;
		grid-template:
			'tbl mr' 1px 
			'tbl mr'
			'tbl .';
	}
	.manage-roles {
		display: grid;
		justify-content: center;
		grid-area: mr;
	}
	.horizontal-form {
		display: flex;
		flex-flow: row;
		align-items: center;
		flex-grow: 1;
		padding-bottom: 10px;
	}
	table {
		border: 1px solid;
		border-collapse: collapse;
		grid-area: tbl;
	}
	table th {
		border: 1px solid;
		background: rgb(240,240,240);
		text-align: center;
	}
	table td {
		border: 1px solid;
		text-align: center;
		padding: 3px;
	}
</style>

@if (SignInManager.IsSignedIn(User))
{
	@if (User.IsInRole("Admin")) // Triple-checking never hurt anyone
	{
		<div>
			<h1 style="text-align:center;">
				Hello, @User.Identity?.Name
			</h1>
			<hr />
			<div class="grid-page">
				<table>
					<thead>
						<tr>
							<th>ID</th>
							<th>Role Name</th>
							<th>&nbsp;</th>
							<th>&nbsp;</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var role in AppDbContext.Roles)
						{
						<tr>
							<td style="font-size:12px; width:10%;">@role.Id</td>
							<td>@role.Name</td>
							<td style="width: 5%;">
								<a asp-action="EditRole" asp-route-id="@role.Id">M</a>
							</td>
							<td style="width:5%;">
								<a asp-action="DeleteRole" asp-route-id="@role.Id">D</a>
							</td>
						</tr>
						}
					</tbody>
				</table>
				<div class="manage-roles">
					<h5>Create New Role</h5>
					<form class="horizontal-form">
						<input class="form-control" autocomplete="off" placeholder="New Role" type="text"/>
						<input type="button" value="Create" class="btn btn-primary" />
					</form>
					<hr />
					<h5>Manage user roles</h5>
					<div>
						<form class="horizontal-form">
							<input class="form-control" autocomplete="off" placeholder="User ID" type="text" />
							<input type="button" value="Chk" class="btn btn-primary" />
						</form>
					</div>
					<div>
						<form class="horizontal-form">
							<input class="form-control" autocomplete="off" placeholder="Role ID To Add" type="text" />
							<input type="button" value="Add" class="btn btn-warning" />
						</form>
						<form class="horizontal-form">
							<input class="form-control" autocomplete="off" placeholder="Role ID To Remove" type="text" />
							<input type="button" value="Rem" class="btn btn-danger" />
						</form>
					</div>
				</div>
			</div>
		</div>
	}
}
